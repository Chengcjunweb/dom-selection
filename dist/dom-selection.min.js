!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.DOMSelection=e.DOMSelection||{})}(this,function(e){function t(){return C.getSelection()||m.selection}function n(e){return e=e||t(),e.rangeCount>0?e.getRangeAt(0):null}function o(e,n){e&&(n=n||t(),n.removeAllRanges(),n.addRange(e))}function r(e){if(e=e||t(),!e.rangeCount)return!1;for(var n=e.getRangeAt(0).cloneRange(),o=n.getClientRects?n.getClientRects():[],r=0;r<o.length;++r){var a=o[r];if(a.left&&a.top&&a.right&&a.bottom)return{left:parseInt(a.left,10),top:parseInt(a.top,10),width:parseInt(a.right-a.left,10),height:parseInt(a.bottom-a.top,10)}}return!1}function a(e){var t=n(e);if(!t)return[];var o=t.startContainer,r=t.endContainer;if(o===r)return[o];for(var a=[];o&&o!==r;)a.push(o=v(o));for(o=t.startContainer;o&&o!==t.commonAncestorContainer;)a.unshift(o),o=o.parentNode;return a}function i(e){if(e=e||t(),!e.rangeCount||e.isCollapsed)return null;for(var n=e.rangeCount,o=m.createElement("div"),r=0;r<n;++r)o.appendChild(e.getRangeAt(r).cloneContents());return o.innerHTML}function f(e){return(e||t()).isCollapsed}function c(e){(e||t()).collapseToStart()}function d(e){(e||t()).collapseToEnd()}function s(e,n){return n=n||t(),e.contains(n.anchorNode)&&e.contains(n.focusNode)}function l(e,t){var n=m.createRange();n.selectNodeContents(e),n.collapse(!1),o(n,t)}function u(e){if(e=e||t(),e.modify)c(e),e.modify("move","backward","word"),e.modify("extend","forward","word");else if("Control"!==e.type){var n=e.createRange();n.collapse(!0),n.expand("word")}}function p(e){e=e||t();var r=n(e);u(e);var a=e.toString();return o(r),a}function g(e){if(e=e||t(),!f(e)){var n=m.createRange();return n.setStart(e.anchorNode,e.anchorOffset),n.setEnd(e.focusNode,e.focusOffset),n.detach(),n.collapsed}}function h(e){if(e=e||t(),!f(e)){var n=e.focusNode,o=e.focusOffset,r=["forward","backward"];g(e)&&r.reverse(),e.collapse(e.anchorNode,e.anchorOffset),e.modify("move",r[0],"character"),e.modify("move",r[1],"word"),e.extend(n,o),e.modify("extend",r[1],"character"),e.modify("extend",r[0],"word")}}var v=function(e,t){if(e.firstChild)return e.firstChild;for(;e;){if(e==t)return null;if(e.nextSibling)return e.nextSibling;e=e.parentNode}},C=window,m=document;e.ver="0.3.2",e.getSelection=t,e.getRange=n,e.setRange=o,e.getRect=r,e.getNodes=a,e.getHTML=i,e.isCollapsed=f,e.collapseStart=c,e.collapseEnd=d,e.isWithin=s,e.forceWithin=l,e.expandToWord=u,e.getCaretWord=p,e.isBackwards=g,e.snapSelected=h,Object.defineProperty(e,"__esModule",{value:!0})});